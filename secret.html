<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/secret.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
    <title>労働-草むしり編-</title>
</head>

<body>
    <div id="gameScreen">
        <h1 id="title">労働　-草むしり編-</h1>
        <p class="roudou">５級目指して草をむしろう！</p>
        <p id="bgm_btn">♪ON</p>
        <audio id="bgm" src="ほっこり村のなつやすみ.mp3" loop></audio>
        <!-- BGMは提供→https://dova-s.jp/bgm/play21316.html -->

        <audio id="sound" src="カーソル移動7.mp3"></audio>
        <!-- 草を抜く時の効果音は→https://soundeffect-lab.info/sound/button/ -->

        <audio id="goal_Sound" src="ラッパのファンファーレ.mp3"></audio>
        <!-- ↑と同じサイトから -->


        <div id="container">
            <img id="field" src="img/kusa-chiikawa.webp" alt="草むしり">
            <div id="kusa">
                <div class="kusa-box1"><img class="weed" id="kusa1" src="img/plant_00001.png" alt="草"></div>
                <div class="kusa-box2"><img class="weed" id="kusa2" src="img/plant_00001.png" alt="草"></div>
                <div class="kusa-box3"><img class="weed" id="kusa3" src="img/plant_00001.png" alt="草"></div>
                <div class="kusa-box4"><img class="weed" id="kusa4" src="img/plant_00001.png" alt="草"></div>
                <div class="kusa-box5"><img class="weed" id="kusa5" src="img/plant_00001.png" alt="草"></div>
            </div>
            <!-- 草のイラストはここから→https://coo-i.com/archives/403 -->
        </div>
    </div>

    <!-- 報酬を受け取る画面 -->
    <div id="clearScreen" style="display:none;">
        <img src="img/kusa-hachiware.jpeg" alt="草ハチワレ" class="money">
        <img src="img/money.jpg" alt="お祝い画像" class="money">
        <div><button id="retryButton">もう一回むしる</button></div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        alert("行く？労働っ")

        bgmButton = document.getElementById('bgm_btn');
        const bgm = document.getElementById('bgm');
        let isPlaying = false;
        bgm.volume = 0.1;

        bgmButton.addEventListener('click', function () {
            if (isPlaying) {
                bgm.pause();
                bgmButton.textContent = '♪ ON';
            } else {
                bgm.play();
                bgmButton.textContent = '♪ OFF';
            }
            isPlaying = !isPlaying;
        });

        $("#kusa1").on("click", function () {
            $("#kusa1").fadeOut(1000);
            let sound = document.getElementById("sound");
            sound.play();
        });

        $("#kusa2").on("click", function () {
            $("#kusa2").fadeOut(1000);
            let sound = document.getElementById("sound");
            sound.play();
        });

        $("#kusa3").on("click", function () {
            $("#kusa3").fadeOut(1000);
            let sound = document.getElementById("sound");
            sound.play();
        });

        $("#kusa4").on("click", function () {
            $("#kusa4").fadeOut(1000);
            let sound = document.getElementById("sound");
            sound.play();
        });

        $("#kusa5").on("click", function () {
            $("#kusa5").fadeOut(1000);
            let sound = document.getElementById("sound");
            sound.play();
        });


        $(document).ready(function () {
            let num_Kusa = $('.weed').length; // 草の数を取得

            $('.weed').on('click', function () {
                $(this).fadeOut(500, function () {
                    num_Kusa--; // マイナス1
                    if (num_Kusa === 0) {
                        showClearScreen(); // 全部消えたらクリア
                    }
                });
            });

            // クリア画面を表示する関数
            function showClearScreen() {
                $('#gameScreen').hide();   // ゲーム画面を非表示
                $('#clearScreen').show();  // クリア画面を表示
                let clearSound = document.getElementById("goal_Sound");
                clearSound.volume = 0.1;
                clearSound.play();
            }

            // 「もう一回むしる」
            $('#retryButton').on('click', function () {
                $('#clearScreen').hide();  // クリア画面を非表示
                $('#gameScreen').show();   // ゲーム画面を表示

                // 草を再表示して数をリセット
                $('.weed').fadeIn(0);       // 草を即座にフェードインで表示
                num_Kusa = $('.weed').length; // 草の数をリセット
            });
        });

    </script>
</body>

</html>